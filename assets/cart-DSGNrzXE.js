import{G as q,j as s,L as f,B as R,l as E,b as S,r as o,C as z,D as v,E as j,H as A,c as C}from"./index-CC-10JTR.js";import{t as D}from"./feautures-W7BkNmvr.js";import{a as N}from"./index-xsH4HHeE.js";import{u as H}from"./useAuthRedirect-BHldWhtT.js";function I(n){return q({attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8.6 1c1.6.1 3.1.9 4.2 2 1.3 1.4 2 3.1 2 5.1 0 1.6-.6 3.1-1.6 4.4-1 1.2-2.4 2.1-4 2.4-1.6.3-3.2.1-4.6-.7-1.4-.8-2.5-2-3.1-3.5C.9 9.2.8 7.5 1.3 6c.5-1.6 1.4-2.9 2.8-3.8C5.4 1.3 7 .9 8.6 1zm.5 12.9c1.3-.3 2.5-1 3.4-2.1.8-1.1 1.3-2.4 1.2-3.8 0-1.6-.6-3.2-1.7-4.3-1-1-2.2-1.6-3.6-1.7-1.3-.1-2.7.2-3.8 1-1.1.8-1.9 1.9-2.3 3.3-.4 1.3-.4 2.7.2 4 .6 1.3 1.5 2.3 2.7 3 1.2.7 2.6.9 3.9.6zM7.9 7.5L10.3 5l.7.7-2.4 2.5 2.4 2.5-.7.7-2.4-2.5-2.4 2.5-.7-.7 2.4-2.5-2.4-2.5.7-.7 2.4 2.5z"},child:[]}]})(n)}const L=({cartItem:n,incrementHandler:l,decrementHandler:d,removerHandler:u})=>{const{photo:h,productId:i,name:t,price:p,quantity:a,materialType:c,size:x}=n;return s.jsxs("div",{className:"cart-item",children:[s.jsx("img",{src:D(h),alt:t}),s.jsxs("article",{children:[s.jsx(f,{style:{whiteSpace:"nowrap"},to:`/product/${i}`,children:t}),s.jsxs("span",{children:["₹",p]}),s.jsx("span",{children:c}),s.jsxs("span",{children:["Size:",x]})]}),s.jsxs("div",{children:[s.jsx("button",{onClick:()=>d(n),children:"-"}),s.jsx("p",{children:a}),s.jsx("button",{onClick:()=>l(n),children:"+"})]}),s.jsx("button",{onClick:()=>u(i),children:s.jsx(R,{})})]})},B=()=>{const n=H(),{cartItems:l,subtotal:d,tax:u,total:h,shippingCharges:i,discount:t,courierCharge:p}=E(e=>e.cartReducer),a=S();if(!n)return s.jsx("div",{className:"auth-redirecting",children:"Redirecting to login..."});const[c,x]=o.useState(""),[g,r]=o.useState(!1),y=e=>{e.quantity>=e.stock||a(C({...e,quantity:e.quantity+1}))},b=e=>{e.quantity<=1||a(C({...e,quantity:e.quantity-1}))},w=e=>{a(A(e))};return o.useEffect(()=>{const{token:e,cancel:m}=N.CancelToken.source(),k=setTimeout(()=>{N.get(`${z}/api/v1/payment/discount?coupon=${c}`,{cancelToken:e}).then(T=>{a(v(T.data.discount)),r(!0),a(j())}).catch(()=>{a(v(0)),r(!1),a(j())}),Math.random()>.5?r(!0):r(!1)},1e3);return()=>{clearTimeout(k),m(),r(!1)}},[c]),o.useEffect(()=>{a(j())},[l]),s.jsxs("div",{className:"cart",children:[s.jsx("main",{children:l.length>0?s.jsx(s.Fragment,{children:l.map((e,m)=>s.jsx(L,{incrementHandler:y,decrementHandler:b,removerHandler:w,cartItem:e},m))}):s.jsx("h1",{children:"No Items Added"})}),s.jsxs("aside",{className:"price-summary",children:[s.jsxs("div",{className:"row",children:[s.jsx("span",{className:"label",children:"Product Rate"}),s.jsxs("span",{className:"value",children:["₹",d]})]}),s.jsxs("div",{className:"row",children:[s.jsx("span",{className:"label",children:"Shipping Charges"}),s.jsxs("span",{className:"value",children:["₹",i]})]}),s.jsxs("div",{className:"row",children:[s.jsx("span",{className:"label",children:"Delivery Charges"}),s.jsxs("span",{className:"value",children:["₹",p]})]}),s.jsxs("div",{className:"row",children:[s.jsx("span",{className:"label",children:"Tax"}),s.jsxs("span",{className:"value",children:["₹",u]})]}),s.jsxs("div",{className:"row",children:[s.jsx("span",{className:"label",children:"Discount"}),s.jsxs("span",{className:"value red",children:["- ₹",t]})]}),s.jsxs("div",{className:"row total",children:[s.jsx("span",{className:"label",children:"Total"}),s.jsxs("span",{className:"value",children:["₹",h]})]}),s.jsx("input",{type:"text",placeholder:"Coupon Code",value:c,onChange:e=>x(e.target.value)}),c&&s.jsx("div",{className:"coupon-feedback",children:g?s.jsxs("span",{className:"green",children:["₹",t," off using ",s.jsx("code",{children:c})]}):s.jsxs("span",{className:"red",children:["Invalid Coupon ",s.jsx(I,{})]})}),l.length>0&&s.jsx(f,{to:"/shipping",children:"Pay Now"})]})]})};export{B as default};
