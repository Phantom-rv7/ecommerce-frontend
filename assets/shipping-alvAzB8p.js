import{l as C,u as S,b as P,r as o,j as t,I,C as N}from"./index-BBhJg91b.js";import{B as $}from"./index-U50_4n8K.js";import{a as k}from"./index-xsH4HHeE.js";const B=()=>{const{cartItems:u,total:h}=C(e=>e.cartReducer),i=S(),g=P(),[r,x]=o.useState({address:"",city:"",state:"",phnumber:"",pinCode:""}),[d,l]=o.useState(!1),n=e=>{x(a=>({...a,[e.target.name]:e.target.value}))},f=async e=>{var p,m;e.preventDefault();const{address:a,city:y,state:b,phnumber:v,pinCode:j}=r;if(!a||!y||!b){alert("Please fill out all address fields.");return}if(!/^\d{6}$/.test(j)){alert("Pin code must be exactly 6 digits.");return}if(!/^\d{10}$/.test(v)){alert("Phone number must be exactly 10 digits.");return}const c=localStorage.getItem("token");if(!c){alert("You must be logged in to proceed with payment.");return}g(I(r)),l(!0);try{const{data:s}=await k.post(`${N}/api/v1/payment/create-order`,{amount:Number(h)},{headers:{Authorization:`Bearer ${c}`}});i("/pay",{state:{orderId:s.id,amount:s.amount,currency:s.currency}})}catch(s){alert(((m=(p=s.response)==null?void 0:p.data)==null?void 0:m.message)||"Payment failed. Please try again.")}finally{l(!1)}};return o.useEffect(()=>{u.length<=0&&i("/cart")},[u,i]),t.jsxs("div",{className:"shipping",children:[t.jsx("button",{className:"back-btn",onClick:()=>i("/cart"),children:t.jsx($,{})}),t.jsxs("form",{onSubmit:f,children:[t.jsx("h1",{children:"Shipping Address"}),t.jsx("input",{required:!0,type:"text",placeholder:"Address",name:"address",value:r.address,onChange:n}),t.jsx("input",{required:!0,type:"text",placeholder:"City",name:"city",value:r.city,onChange:n}),t.jsx("input",{required:!0,type:"text",placeholder:"State",name:"state",value:r.state,onChange:n}),t.jsx("input",{required:!0,type:"text",inputMode:"numeric",maxLength:10,placeholder:"Phone Number",name:"phnumber",value:r.phnumber,onChange:e=>{const a=e.target.value;/^\d*$/.test(a)&&a.length<=10&&n(e)}}),t.jsx("input",{required:!0,type:"text",inputMode:"numeric",maxLength:6,placeholder:"Pin Code",name:"pinCode",value:r.pinCode,onChange:e=>{const a=e.target.value;/^\d*$/.test(a)&&a.length<=6&&n(e)}}),t.jsx("button",{type:"submit",disabled:d,children:d?"Processing...":"Pay Now"})]})]})};export{B as default};
