import{b as f,r as u,q as x,l as j,o as _,j as s,V as a,X as g,L as p}from"./index-CC-10JTR.js";import{u as F}from"./useAuthRedirect-BHldWhtT.js";const b=()=>{const l=f(),t=F(),[c,r]=u.useState(null),[d]=x(),{user:i}=j(e=>e.userReducer),{data:o=[],isLoading:m,refetch:v}=_(i==null?void 0:i._id,{skip:!(i!=null&&i._id)});return!t||!i||!i._id?s.jsx("div",{className:"auth-redirecting",children:"Redirecting to login..."}):s.jsxs("div",{className:"favorites-container",children:[s.jsx("h1",{children:"My Favorites"}),m?s.jsx("p",{children:"Loading..."}):o.length===0?s.jsx("p",{children:"No favorite products yet."}):s.jsx("div",{className:"favorites-list",children:o.map(e=>{var n;return!e||!e._id||!e.name||!e.photos||e.photos.length===0||!((n=e.photos[0])!=null&&n.url)?null:s.jsxs("div",{className:"favorite-item",children:[s.jsx("button",{className:"remove-favorite-btn",onClick:async()=>{r(e._id);try{if(!t||!i||!i._id){a.error("You must be logged in to remove favorites");return}await d({userId:i._id,productId:e._id}).unwrap(),await v(),l(g.util.invalidateTags(["Favorites"])),a.success("Removed from favorites")}catch(h){console.error("Failed to remove favorite:",h),a.error("Failed to remove favorite")}finally{r(null)}},children:c===e._id?"...":"ðŸ’”"}),s.jsx("img",{src:e.photos[0].url,alt:e.name,className:"favorite-item__image"}),s.jsxs("div",{className:"favorite-item__details",children:[s.jsx("h4",{children:e.name}),s.jsxs("p",{className:"price",children:["â‚¹",e.price]}),s.jsxs("p",{style:{fontFamily:"monospace"},className:"discount",children:[e.off,"% OFF"]})]}),s.jsx(p,{to:`/product/${e._id}`,children:s.jsx("button",{className:"buy-now-btn",children:"Explore"})})]},e._id)})})]})};export{b as default};
