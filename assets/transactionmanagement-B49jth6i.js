import{l as F,k as H,aa as Q,u as U,r as x,a1 as z,ab as G,ac as J,j as s,N as K,S as V,B as W,L as m}from"./index-CC-10JTR.js";import{A as X}from"./AdminSidebar-DgeFAT8R.js";import{r as E}from"./feautures-W7BkNmvr.js";import"./index-Bs-J1ZhJ.js";const ns=()=>{const{user:a}=F(e=>e.userReducer),{id:i}=H(),{data:t,isLoading:o,isError:p}=Q(i,{skip:!i}),l=U(),[$,j]=x.useState(!1),{data:h,isLoading:A,isError:M,refetch:f}=z(a==null?void 0:a._id,{refetchOnMountOrArgChange:!0,skip:!!i});x.useEffect(()=>{i||f()},[f,i]);const[L]=G(),[D]=J(),[c,N]=x.useState(1),g=5,b=(h==null?void 0:h.orders)||[],C=Math.ceil(b.length/g),w=b.slice((c-1)*g,c*g),R=async(e,r)=>{const d=await L({orderId:e,userId:r});E(d,l,"/admin/transaction")},B=async(e,r)=>{const d=await D({orderId:e,userId:r});E(d,l,"/admin/transaction")};if(M||p)return s.jsx(K,{to:"/404"});const v=e=>{var r,d,y,I,P,S,k;return s.jsxs("section",{style:{padding:"2rem"},children:[s.jsxs("h2",{children:["Order ID: ",e._id]}),s.jsxs("h4",{children:["User: ",(r=e.user)==null?void 0:r.name]}),s.jsxs("div",{className:"shipping-info",children:[s.jsx("h4",{children:"Shipping Info"}),s.jsxs("div",{className:"shipping-field",children:[s.jsx("strong",{children:"Name:"})," ",(d=e.user)==null?void 0:d.name]}),s.jsxs("div",{className:"shipping-field",children:[s.jsx("strong",{children:"Address:"})," ",(y=e.shippingInfo)==null?void 0:y.address]}),s.jsxs("div",{className:"shipping-field",children:[s.jsx("strong",{children:"City:"})," ",(I=e.shippingInfo)==null?void 0:I.city]}),s.jsxs("div",{className:"shipping-field",children:[s.jsx("strong",{children:"State:"})," ",(P=e.shippingInfo)==null?void 0:P.state]}),s.jsxs("div",{className:"shipping-field",children:[s.jsx("strong",{children:"Pin Code:"})," ",(S=e.shippingInfo)==null?void 0:S.pinCode]}),s.jsxs("div",{className:"shipping-field",children:[s.jsx("strong",{children:"Phone:"})," ",(k=e.shippingInfo)==null?void 0:k.phnumber]}),s.jsx("button",{className:"copy-shipping-btn",onClick:()=>{const n=e.shippingInfo,u=`
              Address: ${n==null?void 0:n.address}
              City: ${n==null?void 0:n.city}
              State: ${n==null?void 0:n.state}
              Pin Code: ${n==null?void 0:n.pinCode}
              Phone: ${n==null?void 0:n.phnumber}
                  `.trim();navigator.clipboard.writeText(u),j(!0),setTimeout(()=>j(!1),2e3)},children:"Copy Shipping Info"}),$&&s.jsx("span",{className:"copy-feedback",children:"Copied"})]}),e.orderItems.map(n=>{var O,_,T;const u=((T=(_=(O=n.productId)==null?void 0:O.photos)==null?void 0:_[0])==null?void 0:T.url)||"";return s.jsx(Y,{...n,photo:u},n._id)}),s.jsxs("p",{children:["Status:"," ",s.jsx("span",{className:e.status==="Delivered"?"purple":e.status==="Shipped"?"green":"red",children:e.status})]}),s.jsxs("p",{children:["Total: ₹",e.total]}),s.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem",justifyContent:"center"},children:[s.jsx("button",{style:{marginRight:"4px"},className:"shipping-btn",onClick:()=>R(e._id,e.user._id),children:"Process Status"}),s.jsx("button",{className:"product-delete-btn",onClick:()=>B(e._id,e.user._id),children:s.jsx(W,{})}),i&&s.jsx(m,{to:"/admin/transaction",children:"← Back"}),!i&&s.jsx(m,{to:`/admin/transaction/${e._id}`,children:"Manage"})]})]},e._id)};return s.jsxs("div",{className:"admin-container",children:[s.jsx(X,{}),s.jsx("main",{className:"product-management",children:A||o?s.jsx(V,{}):i?t!=null&&t.order?v(t.order):s.jsxs("p",{style:{padding:"2rem"},children:["No order found for ID: ",i]}):s.jsx(s.Fragment,{children:w.map(e=>v(e))})}),!i&&s.jsxs("div",{className:"pagination-controls",children:[s.jsx("button",{disabled:c===1,onClick:()=>N(e=>e-1),children:"Prev"}),s.jsxs("span",{children:["Page ",c," of ",C]}),s.jsx("button",{disabled:c===C,onClick:()=>N(e=>e+1),children:"Next"})]})]})},Y=({name:a,photo:i,price:t,quantity:o,productId:p})=>s.jsxs("div",{className:"transaction-product-card",children:[s.jsx("img",{src:i||"/fallback.jpg",alt:a,onError:l=>{l.currentTarget.src="/fallback.jpg"}}),s.jsx(m,{to:`/product/${p._id}`,children:a}),s.jsxs("span",{children:["₹",t," × ",o," = ₹",t*o]})]});export{ns as default};
